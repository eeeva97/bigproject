---
title: "Final Report"
author: "Hazel Ethier and Eva Gerstle"
date: "3/27/2018"
output: pdf_document
---
```{r include=FALSE}
library(tidyverse)
library(ipumsr)
library(mosaic)
library(Stat2Data)
library(dplyr)
library(ggplot2)
setwd("~/Desktop")

project_ddi <- read_ipums_ddi("usa_00005.xml")
project_data <- read_ipums_micro(project_ddi, verbose = FALSE)

```

```{r}
project_data <- project_data %>%
  mutate(
    Northeast=if_else(REGION == 11 | REGION == 12, 1 ,0),
    Midwest=if_else(REGION == 21 | REGION == 22, 1, 0),
    South=if_else(REGION == 31 | REGION == 32 | REGION == 33,1,0),
    West=if_else(REGION == 41 | REGION == 42,1,0)
  ) %>%
  mutate(
    white=if_else(RACE == 1,1,0),
    black =if_else(RACE == 2,1,0),
    nativeamerican=if_else(RACE==3,1,0),
    asian=if_else(RACE==4 | RACE==5 | RACE==6,1,0),
    otherrace=if_else(RACE==7,1,0),
    twoormore=if_else(RACE==8 | RACE == 9,1,0)
  ) %>%
  mutate(
    CINETHH= as.factor(if_else(CINETHH == 1 | CINETHH == 2, 1,0))
  ) %>%
  mutate(
    FARM= as.factor(if_else(FARM == 2, 1,0))
  ) %>%
  mutate(
    SSMC= as.factor(if_else(SSMC == 1 | SSMC == 2, 1,0))
  ) %>%
  mutate(
    MULTGEN= as.factor(if_else(MULTGEN == 3, 1,0))
  ) %>%
  select(PERNUM, SERIAL, Northeast, Midwest, South, West, AGE, RACE, SSMC, FARM, CINETHH, MULTGEN, HHINCOME, NCHLT5, white, black, nativeamerican, asian, otherrace, twoormore, NUMPREC)
str(project_data, give.attr = FALSE)
```
#Tertiary Question
```{r}
tertiarydata <- project_data %>%
  filter(MULTGEN == 1)

justincomeplot <- ggplot(tertiarydata, aes(x=NUMPREC, y= HHINCOME)) + geom_jitter(alpha =.1, color ="blue") 
justincomeplot

m1 <- lm(HHINCOME~NUMPREC, data=tertiarydata)
summary(m1)

```


```{r}
modeltertiary <- lm(HHINCOME~NUMPREC + Midwest*NUMPREC + South*NUMPREC + West*NUMPREC + AGE + FARM + NCHLT5 + black*NUMPREC + nativeamerican*NUMPREC + asian*NUMPREC + otherrace*NUMPREC + twoormore*NUMPREC + CINETHH + SSMC, data=tertiarydata)
modeltertiarysmall <- lm(HHINCOME~NUMPREC + Midwest*NUMPREC + South*NUMPREC + West*NUMPREC, data=tertiarydata)
anova(modeltertiarysmall, modeltertiary)
#summary(modeltertiarysmall)
#summary(modeltertiary)

```
Our model concludes that intergenerational household, defined as households with three or more generations living under the same roof, living in different regions of the United States, have statistically different incomes. In order to test our model, we removed our variables one at a time, and ran various nested F tests, finding that each time, the full model (the tertiary model with the confounding variables included) was needed.  Thus we interpreted our variables adjusting for race, internet access, same-sex relationship status, age, number of children under 5, and farm status.

For an intergenerational household living in the Northeast, (Connecticut, Maine, Massachusetts, New Hampshire, Rhode Island, Vermont, New Jersey, New York, Pennsylvania), with 3 people (the minimum number required to have an inter generational household), the predicated annual household income is $50346.082. With each additional household member, in the Northeast, income is predicated to increase by \$10386.652, adjusted for race, internet access, same-sex relationship status, age, number of children under 5, and farm status. 

Whereas for intergenerational household living in the Midwest (Illinois, Indiana, Michigan, Ohio, Wisconsin, Iowa, Kansas, Minnesota, Missouri, Nebraska, North Dakota, South Dakota) with 3 people, the predicated annual household income is \$37730.064. With each additional household member, income is predicated to increase by \$5856.693, adjusted for race, internet access, same-sex relationship status, age, number of children under 5, and farm status. 

In the South, (Delaware, District of Columbia, Florida, Georgia, Maryland, North Carolina, South Carolina, Virginia, West Virginia, Alabama, Kentucky, Mississippi, Tennessee, Arkansas, Louisiana, Oklahoma, Texas) for intergenerational households with 3 people, the predicated annual household income is $38528.84. With each additional household member, income is predicated to increase by \$5844.596, adjusted for race, internet access, same-sex relationship status, age, number of children under 5, and farm status. 

Out in the Western States (Arizona, Colorado, Idaho, Montana, Nevada, New Mexico, Utah, Wyoming, Alaska, California, Hawaii, Oregon, Washington), intergenerational households with 3 people have a predicated annual household income of \$42643.982, With each additional household member, income is predicated to increase by \$7931.779, adjusted for race, internet access, same-sex relationship status, age, number of children under 5, and farm status. 
