---
title: "Technical Report"
author: "Hazel Ethier and Eva Gerstle"
date: "4/19/2018"
output: pdf_document
---

\newpage

```{r include=FALSE, message=FALSE}
library(tidyverse)
library(ipumsr)
library(mosaic)
library(Stat2Data)
library(dplyr)
library(ggplot2)
library(lmtest)
setwd("~/Desktop")

project_ddi <- read_ipums_ddi("usa_00005.xml")
project_data <- read_ipums_micro(project_ddi, verbose = FALSE)

```

```{r}
project_data <- project_data %>%
  mutate(
    Northeast=if_else(REGION == 11 | REGION == 12, 1 ,0),
    Midwest=if_else(REGION == 21 | REGION == 22, 1, 0),
    South=if_else(REGION == 31 | REGION == 32 | REGION == 33,1,0),
    West=if_else(REGION == 41 | REGION == 42,1,0)
  ) %>%
  mutate(
    white=if_else(RACE == 1,1,0),
    black =if_else(RACE == 2,1,0),
    nativeamerican=if_else(RACE==3,1,0),
    asian=if_else(RACE==4 | RACE==5 | RACE==6,1,0),
    otherrace=if_else(RACE==7,1,0),
    twoormore=if_else(RACE==8 | RACE == 9,1,0)
  ) %>%
  mutate(
    CINETHH= as.factor(if_else(CINETHH == 1 | CINETHH == 2, 1,0))
  ) %>%
  mutate(
    FARM= as.factor(if_else(FARM == 2, 1,0))
  ) %>%
  mutate(
    SSMC= as.factor(if_else(SSMC == 1 | SSMC == 2, 1,0))
  ) %>%
  mutate(
    MULTGEN= as.factor(if_else(MULTGEN == 3, 1,0))
  ) %>%
  select(PERNUM, SERIAL, Northeast, Midwest, South, West, AGE, RACE, SSMC, FARM, CINETHH, MULTGEN, HHINCOME, NCHLT5, white, black, nativeamerican, asian, otherrace, twoormore, NUMPREC)
str(project_data, give.attr = FALSE)
```
#Introduction

  
#Results

##Primary Question 

\textbf{Randomization:}

We got our data from the American Community Survey on IPUMS USA. This survey is a 1-in-100 national random sample of the population. Because the sampling method is randomized, this condition is met. 

\textbf{Independence:}

Since our data is from the American Community Survey on IPUMS USA which uses a random sampling method and has a large sample size, we do not have any reason to think that whether one household is intergenerational would impact if another household is intergenerational. 

\textbf{Linearity:}

Our data consists of a binary response variable of whether a household is intergenerational and a categorical explanatory variable that we made into three indicator variables. Since we can connect a straight line between any two binary variables, our data is linear. 

```{r}
primarymodel <- glm(MULTGEN ~ West + Midwest + South + AGE + HHINCOME + NUMPREC + NCHLT5 + NUMPREC*NCHLT5 + FARM + black + nativeamerican + asian +otherrace + twoormore , family=binomial, data = project_data)
summary(primarymodel)
```
```{r}
exp(coef(primarymodel))
```

```{r}
#Likelihood Test for Interaction Between Number of Children Under 5 and Number of People in the House

model2<- glm(MULTGEN ~ West + Midwest + South + AGE + HHINCOME + NUMPREC + NCHLT5 + FARM + black + nativeamerican + asian +otherrace + twoormore , family=binomial, data = project_data)

lrtest(model2, primarymodel)
```

##Secondary Question

\textbf{Randomization:}

We got our data from the American Community Survey on IPUMS USA. This survey is a 1-in-100 national random sample of the population. Because the sampling method is randomized, this condition is met. 

\textbf{Independence:}

Since our data is from the American Community Survey on IPUMS USA which uses a random sampling method and has a large sample size, we do not have any reason to think that whether one household is intergenerational would impact if another household is intergenerational. 

\textbf{Linearity:}

Insert graphic here of income vs. intergenerational 

##Tertiary Question
```{r, echo=FALSE}
tertiarydata <- project_data %>%
  filter(MULTGEN == 1)


justincomeplot <- ggplot(tertiarydata, aes(x=NUMPREC, y= HHINCOME)) + geom_jitter(alpha =.1, color ="blue") 
justincomeplot

m1 <- lm(HHINCOME~NUMPREC, data=tertiarydata)
summary(m1)

modeltertiary <- lm(HHINCOME~NUMPREC + Midwest*NUMPREC + South*NUMPREC + West*NUMPREC + AGE + FARM + NCHLT5 + black*NUMPREC + nativeamerican*NUMPREC + asian*NUMPREC + otherrace*NUMPREC + twoormore*NUMPREC + CINETHH + SSMC, data=tertiarydata)

modeltertiarysmall <- lm(HHINCOME~NUMPREC + Midwest*NUMPREC + South*NUMPREC + West*NUMPREC, data=tertiarydata)
anova(modeltertiarysmall, modeltertiary)
summary(modeltertiarysmall)
summary(modeltertiary)

```
```{r}
tally(~MULTGEN, data=project_data)
```

```{r}
plot(modeltertiary, which=1)
plot(modeltertiary, which=2)
```

\textbf{Linearity:}

\textbf{Normality:}

\textbf{Independence:}

\textbf{Zero Mean:}

\textbf{Equal Variance:}


The United States Census divides the country into 4 regions: Northeast (Connecticut, Maine, Massachusetts, New Hampshire, Rhode Island, Vermont, New Jersey, New York, Pennsylvania), Midwest (Illinois, Indiana, Michigan, Ohio, Wisconsin, Iowa, Kansas, Minnesota, Missouri, Nebraska, North Dakota, South Dakota), South (Delaware, District of Columbia, Florida, Georgia, Maryland, North Carolina, South Carolina, Virginia, West Virginia, Alabama, Kentucky, Mississippi, Tennessee, Arkansas, Louisiana, Oklahoma, Texas), and West (Arizona, Colorado, Idaho, Montana, Nevada, New Mexico, Utah, Wyoming, Alaska, California, Hawaii, Oregon, Washington). [^2]